package day17.practice.service;

import day17.practice.vo.product;

public class ShopServiceImp implements ShopService {

	@Override
	public int store(product[] productList, int count, product product) {
		//if no such product exists in the list. not store and just return the current count
		if(product == null) {
			return count;
		}
		if(productList == null) {
			return 0;
		}
		
		if(productList.length < count) {
			return productList.length;
		}
		if(count < 0) {
			return 0;
		}
		
		int index = indexOf(productList, count, product);
		if(index != -1) {
			productList[index].store(product.getAmount());
			return count;
		}
		if(count == productList.length) {
			return count;
		}
		productList[count] = new product(product);
		return count + 1;
	}

	private int indexOf(product[] productList, int count, product product) {
		if(product == null || product.getProductName() == null) {
			return -1;
		}
		if(productList == null) {
			return -1;
		}
		if(count > productList.length || count < 0) {
			count = productList.length;
		}
		for(int i = 0; i < count; i++) {
			product tmp = productList[i];
			if(tmp == null || 
					tmp.getProductName() == null || 
					product.getProductName() == null) {
				return -1;
			}
			if(tmp.getProductName().equals(product.getProductName())) {
				return i;
			}
		}
		return -1;
	}

	@Override
	public void printProduct(product[] productList, int count, String search) {
		if(productList == null || search == null) {
			System.out.println("No such product is found!");
			return;
		}
		int index = indexOf(productList, count, new product(search));
		if(index == -1) {
			System.out.println("No such product is found!");
			return;
		}
		productList[index].printProduct();
	}
	
}
